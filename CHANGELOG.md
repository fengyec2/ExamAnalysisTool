
***

# 更新日志

***

## 版本 1.4.1

### 重写
- **主页面**：
  - 使用 CTkScrollableFrame 代替 listbox
### 修复
- **进度条**：
  - 现在会正确显示进度

***

## 版本 1.4.0

### 重写
- **主页面**：
  - 主页面使用 `customtkinter` 重写，代替 `pyqt5`
- **已知问题**：
  - 文件拖拽未完成
  - 列表右键操作未完成
  - 进度条不能正确更新

***

## 版本 1.3.3

### 新增
- **年级排名折线图**：
  - 支持选择输出的格式：`PDF` 或 `PNG`
### 优化
- **Excel 读取**：
  - 使用统一的 `DataProcessor` 校验文件合法性
- **文本**：
  - 调整了部分文本
- **年级排名折线图**：
  - 现在 X 轴只会显示整数

***

## 版本 1.3.2

### 修复
- **文件拖放**：
  - 现在可以正常进行文件拖放操作
- **生成年级排名折线图**：
  - 将严格按照考试编号排序
### 新增
- **置顶**：
  - 加入了置顶功能
### 其他
- 使用 `QFileDialog` 代替 `filedialog`

***

## 版本 1.3.1

### 重构
- **主页面**：
  - 使用 `PyQt5` 代替 `ttk`
### 新增
- **文件列表**：
  - 支持添加/删除文件操作
- **程序图标**：
  - 添加程序图标
### 修复
- **文件列表**：
  - 删除文件闪退

***

## 版本 1.3.0

### 程序重构
- **拆分了很多长方法**：
  - 没有功能更新，只包含了代码重构
  - 添加了“关于”页面
  - 以前的版本不包含 License 或开源地址，故不再提供下载
### 修复
- **进度条**：
  - 进度条现在会正确反应处理进度

***

## 版本 1.2.2

### 修改
- **修改必须列名**：
  - 将必须列名“同学”改为“姓名”，“年级排名”改为“级名”
  - 后续可能会增加相关设置
  - 代码可能需要重构，现在写的有点高血压

***

## 版本 1.2.1（生成历次考试成绩单功能）

### 新增
- **生成历次考试成绩单**：
  - 添加了新功能以整合所选 Excel 文件中的相同同学的成绩，并生成单独的成绩单

### 修改
- **文件处理**：
  - 添加了在保存文件之前检查文件是否被占用的逻辑

### 改进
- **异常处理**：
  - 增强了读取和写入 Excel 文件的错误处理
  - 优化列表显示效果

***

## 版本 1.2.0（多线程支持）

### 性能
- **多线程**: 
  - 继续优化后台操作的线程管理，操作时不会卡住 UI
  - 在后台线程执行任务时，禁用相关按钮以防止重复操作

### 改进
- **进度条**: 
  - 在计算进退步系数和生成年级排名折线图过程中，进度条将实时更新
  - 处理数据或读取文件时，进度条将反映进度
  - 生成年级排名折线图时可能不能反映最真实的进度，但是先就这样吧

### 用户
- **取消操作**: 
  - 可以取消当前操作
  
### 错误
- **数据有效性检查**: 
  - 在缺少必要列时提供明确的提示
  - 现在会处理文件被占用的异常
  - 现在会检查是否有重复的考试编号

***

## 版本 1.1.0（基本成型）

### 新增
- **保存目录选择**: 在保存进退步系数的 Excel 文件时，添加了用户选择保存目录的功能。
- **包括所有考试排名**: 输出的 Excel 文件现在包含所有提供的同学历次考试的排名，而非仅仅是最新两次的排名。
- **记录进退步系数**: 仍将进退步系数基于最新两次考试的排名进行计算，并在输出中提供。

### 改进
- **PDF 生成功能**: 
  - 在生成每位同学的年级排名折线图时，程序已优化为只询问一次保存目录，后续所有图表将使用相同的目录保存。
  - 在生成完毕后，将清除保存目录选项，以便下次点击时重新选择。

### 错误
- **数据验证**: 
  - 增强了数据加载和验证的错误处理，确保用户在运行分析时能够得到及时的提示反馈。
  - 现在会检查同学排名是否在最新两次考试中均存在

***

## 版本 1.0.0（第一版）

### 新增
- **基本功能**: 基本处理功能已经做好了，后续再优化异常处理和多线程任务

***